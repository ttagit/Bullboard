<!DOCTYPE html>

<html>
<head>
	<title>Hello, redirecting...</title>
</head>
<body>
	
    <script type="text/javascript">
    function crossriderMain($) {
        
        appAPI.db.async.get('hello', function(code) {
        // runs in the context of the extension
        $.globalEval(code.replace('CONTEXT','EXTN'));
    
        // Alternatively, run in context of page DOM
        $('<script type="text/javascript">')
          .html(code.replace('CONTEXT','PAGE DOM')).appendTo('head');
          
        });
        
            
        var vars = {};
    
        var parts = decodeURIComponent( (window.location.href).replace(/\+/g,  " ")).replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        	vars[key] = value;
    	});  
        
        
        appAPI.db.async.set('user-session',vars);
        
           
    }
    </script>
	<script>
		// DEBUG
		// The sign in has failed, if the window is not returned, probably because the hash is wrong
		// Add the hash to the window for debugging purposes.
		//document.body.appendChild(document.createTextNode("Failed to recognize URL query: "+window.location.href));
        
	</script>
</body>
<h1>Thank you for logging in, you may close this window now </p>
<p id="info"> </p>
</html>